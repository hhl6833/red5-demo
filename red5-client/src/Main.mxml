<?xml version="1.0"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009"
               xmlns:mx="library://ns.adobe.com/flex/mx"
               xmlns:s="library://ns.adobe.com/flex/spark">
    <fx:Script><![CDATA[
        import spark.components.Alert;

        private var rtmpURL:String = "rtmp://localhost/oflaDemo";
        private var conn:NetConnection = new NetConnection();
        private var isConnectSuccess:Boolean = false;
        private var netStream:NetStream;
        private var video:Video = new Video();

        NetConnection.prototype.onBWCheck = function ():void {
        };
        NetConnection.prototype.onBWDone = function ():void {
        };

        private function clickConnect(e:MouseEvent):void {
            if (!isConnectSuccess) {
                conn.addEventListener(NetStatusEvent.NET_STATUS, netStatus);
                conn.connect(rtmpURL);
            }
        }

        private function netStatus(e:NetStatusEvent):void {
            trace(e.info.code);
            if (e.info.code == "NetConnection.Connect.Success") {
                isConnectSuccess = true;
                ui.addChild(video);
                video.width = 500;
                video.height = 500;
                netStream = new NetStream(conn);
                netStream.play(rtmpURL + "/ok.fly");
                video.attachNetStream(netStream);
            }
        }
        ]]></fx:Script>
    <s:layout>
        <s:VerticalLayout/>
    </s:layout>
    <mx:UIComponent id="ui" width="500" height="500"/>
    <s:Button x="378" y="369" label="Button" click="this.clickConnect(event)"/>
</s:Application>
